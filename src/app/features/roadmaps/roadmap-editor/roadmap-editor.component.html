<div class="editor-page">
  <header class="page-header anim-fade-in">
    <a routerLink="/roadmaps" class="back-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <polyline points="15 18 9 12 15 6" />
      </svg>
      Volver
    </a>
    <h1>{{ isEditMode() ? 'Editar' : 'Nuevo' }} Roadmap</h1>
  </header>

  <form [formGroup]="roadmapForm" (ngSubmit)="onSubmit()" class="roadmap-form anim-fade-in anim-delay-1">
    @if (errorMessage()) {
      <div class="error-alert" role="alert">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10" />
          <line x1="15" y1="9" x2="9" y2="15" />
          <line x1="9" y1="9" x2="15" y2="15" />
        </svg>
        {{ errorMessage() }}
      </div>
    }

    <div class="form-row">
      <div class="form-group">
        <label for="title">Título *</label>
        <input id="title" type="text" formControlName="title" placeholder="Ej: Desarrollo Frontend con Angular" />
        @if (roadmapForm.get('title')?.touched && roadmapForm.get('title')?.errors?.['required']) {
          <span class="error-text">El título es requerido</span>
        }
      </div>
    </div>

    <div class="form-group">
      <label for="description">Descripción *</label>
      <textarea
        id="description"
        formControlName="description"
        rows="3"
        placeholder="Describe el objetivo y contenido del roadmap..."
      ></textarea>
      @if (roadmapForm.get('description')?.touched && roadmapForm.get('description')?.errors?.['required']) {
        <span class="error-text">La descripción es requerida</span>
      }
    </div>

    <div class="form-row two-cols">
      <div class="form-group">
        <label for="category">Categoría</label>
        <select id="category" formControlName="category">
          <option value="frontend">Frontend</option>
          <option value="backend">Backend</option>
          <option value="fullstack">Fullstack</option>
          <option value="devops">DevOps</option>
          <option value="mobile">Mobile</option>
          <option value="data-science">Data Science</option>
          <option value="ai-ml">AI/ML</option>
          <option value="other">Otro</option>
        </select>
      </div>

      <div class="form-group">
        <label for="difficulty">Dificultad</label>
        <select id="difficulty" formControlName="difficulty">
          <option value="beginner">Principiante</option>
          <option value="intermediate">Intermedio</option>
          <option value="advanced">Avanzado</option>
          <option value="expert">Experto</option>
        </select>
      </div>
    </div>

    <div class="form-row two-cols">
      <div class="form-group">
        <label for="estimatedHours">Horas Estimadas</label>
        <input id="estimatedHours" type="number" formControlName="estimatedHours" min="1" />
      </div>

      <div class="form-group">
        <label for="tags">Tags (separados por coma)</label>
        <input id="tags" type="text" formControlName="tags" placeholder="angular, typescript, web" />
      </div>
    </div>

    <div class="form-group checkbox-group">
      <label>
        <input type="checkbox" formControlName="isPublic" />
        Hacer público este roadmap
      </label>
    </div>

    <div class="editor-placeholder">
      <div class="placeholder-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <polygon points="12 2 2 7 12 12 22 7 12 2" />
          <polyline points="2 17 12 22 22 17" />
          <polyline points="2 12 12 17 22 12" />
        </svg>
      </div>
      <h3>Editor Visual de Nodos</h3>
      <p>El editor visual de roadmaps estará disponible próximamente.</p>
      <p>Podrás crear nodos, conectarlos y añadir recursos interactivamente.</p>
    </div>

    <div class="form-actions">
      <a routerLink="/roadmaps" class="btn-cancel">Cancelar</a>
      <button type="submit" [disabled]="roadmapForm.invalid || isLoading()" class="btn-primary">
        @if (isLoading()) {
          <div class="btn-spinner" aria-hidden="true"></div>
          Guardando...
        } @else {
          {{ isEditMode() ? 'Actualizar' : 'Crear' }} Roadmap
        }
      </button>
    </div>
  </form>
</div>
